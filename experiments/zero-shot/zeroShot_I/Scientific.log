(Recformer) admin@lablinux:~/Elaine/RecFormer$ time python zero-shot.py --pretrain_ckpt /home/admin/Elaine/RecFormer/pretrain_ckpt/recformer_seqrec_ckpt.bin --data_path /home/admin/Elaine/RecFormer/finetune_data/dataset/meta/Scientific --num_train_epochs 128 --batch_size 16 --device 0 --fp16 --finetune_negative_sample_size -1 > /home/admin/Elaine/RecFormer/zeroShot_I/Scientific.log 2>&1

real    0m43.775s
user    0m43.018s
sys     0m6.533s


Global seed set to 42
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LongformerTokenizer'. 
The class this function is called from is 'RecformerTokenizer'.
Namespace(pretrain_ckpt='/home/admin/Elaine/RecFormer/pretrain_ckpt/recformer_seqrec_ckpt.bin', data_path='/home/admin/Elaine/RecFormer/finetune_data/dataset/meta/Scientific', output_dir='checkpoints', ckpt='best_model.bin', model_name_or_path='allenai/longformer-base-4096', train_file='train.json', dev_file='val.json', test_file='test.json', item2id_file='smap.json', meta_file='meta_data.json', preprocessing_num_workers=8, dataloader_num_workers=0, temp=0.05, num_train_epochs=128, gradient_accumulation_steps=8, finetune_negative_sample_size=-1, metric_ks=[10, 50], batch_size=16, learning_rate=5e-05, weight_decay=0, warmup_steps=100, device=0, fp16=True, fix_word_embedding=False, verbose=3)
[Preprocessor] Use cache: /home/admin/Elaine/RecFormer/finetune_data/dataset/meta/Scientific/preprocess/tokenized_items_Scientific
Successfully load 4370 tokenized items.
[Item Embeddings] Use cache: /home/admin/Elaine/RecFormer/finetune_data/dataset/meta/Scientific/preprocess/tokenized_items_Scientific
Initalize item embeddings from vectors.

Evaluate:   0%|                                                             | 0/139 [00:00<?, ?it/s]/home/admin/anaconda3/envs/Recformer/lib/python3.10/site-packages/transformers/modeling_utils.py:862: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(

Evaluate:   1%|▍                                                    | 1/139 [00:00<01:21,  1.69it/s]
Evaluate:   1%|▊                                                    | 2/139 [00:00<01:03,  2.16it/s]
Evaluate:   2%|█▏                                                   | 3/139 [00:01<00:50,  2.68it/s]
Evaluate:   3%|█▌                                                   | 4/139 [00:01<00:46,  2.93it/s]
Evaluate:   4%|█▉                                                   | 5/139 [00:01<00:45,  2.96it/s]
Evaluate:   4%|██▎                                                  | 6/139 [00:02<00:39,  3.34it/s]
Evaluate:   5%|██▋                                                  | 7/139 [00:02<00:38,  3.47it/s]
Evaluate:   6%|███                                                  | 8/139 [00:02<00:35,  3.73it/s]
Evaluate:   6%|███▍                                                 | 9/139 [00:02<00:34,  3.74it/s]
Evaluate:   7%|███▋                                                | 10/139 [00:03<00:32,  3.93it/s]
Evaluate:   8%|████                                                | 11/139 [00:03<00:37,  3.44it/s]
Evaluate:   9%|████▍                                               | 12/139 [00:03<00:40,  3.17it/s]
Evaluate:   9%|████▊                                               | 13/139 [00:04<00:41,  3.01it/s]
Evaluate:  10%|█████▏                                              | 14/139 [00:04<00:43,  2.90it/s]
Evaluate:  11%|█████▌                                              | 15/139 [00:04<00:37,  3.31it/s]
Evaluate:  12%|█████▉                                              | 16/139 [00:05<00:35,  3.44it/s]
Evaluate:  12%|██████▎                                             | 17/139 [00:05<00:33,  3.69it/s]
Evaluate:  13%|██████▋                                             | 18/139 [00:05<00:31,  3.81it/s]
Evaluate:  14%|███████                                             | 19/139 [00:05<00:33,  3.63it/s]
Evaluate:  14%|███████▍                                            | 20/139 [00:06<00:30,  3.84it/s]
Evaluate:  15%|███████▊                                            | 21/139 [00:06<00:34,  3.40it/s]
Evaluate:  16%|████████▏                                           | 22/139 [00:06<00:31,  3.66it/s]
Evaluate:  17%|████████▌                                           | 23/139 [00:06<00:31,  3.69it/s]
Evaluate:  17%|████████▉                                           | 24/139 [00:07<00:32,  3.55it/s]
Evaluate:  18%|█████████▎                                          | 25/139 [00:07<00:35,  3.24it/s]
Evaluate:  19%|█████████▋                                          | 26/139 [00:07<00:35,  3.17it/s]
Evaluate:  19%|██████████                                          | 27/139 [00:08<00:37,  3.00it/s]
Evaluate:  20%|██████████▍                                         | 28/139 [00:08<00:34,  3.20it/s]
Evaluate:  21%|██████████▊                                         | 29/139 [00:08<00:32,  3.35it/s]
Evaluate:  22%|███████████▏                                        | 30/139 [00:08<00:28,  3.79it/s]
Evaluate:  22%|███████████▌                                        | 31/139 [00:09<00:30,  3.52it/s]
Evaluate:  23%|███████████▉                                        | 32/139 [00:09<00:33,  3.22it/s]
Evaluate:  24%|████████████▎                                       | 33/139 [00:09<00:30,  3.51it/s]
Evaluate:  24%|████████████▋                                       | 34/139 [00:10<00:30,  3.49it/s]
Evaluate:  25%|█████████████                                       | 35/139 [00:10<00:28,  3.66it/s]
Evaluate:  26%|█████████████▍                                      | 36/139 [00:10<00:26,  3.86it/s]
Evaluate:  27%|█████████████▊                                      | 37/139 [00:11<00:29,  3.41it/s]
Evaluate:  27%|██████████████▏                                     | 38/139 [00:11<00:27,  3.67it/s]
Evaluate:  28%|██████████████▌                                     | 39/139 [00:11<00:24,  4.07it/s]
Evaluate:  29%|██████████████▉                                     | 40/139 [00:11<00:22,  4.41it/s]
Evaluate:  29%|███████████████▎                                    | 41/139 [00:11<00:21,  4.56it/s]
Evaluate:  30%|███████████████▋                                    | 42/139 [00:12<00:21,  4.42it/s]
Evaluate:  31%|████████████████                                    | 43/139 [00:12<00:25,  3.70it/s]
Evaluate:  32%|████████████████▍                                   | 44/139 [00:12<00:24,  3.82it/s]
Evaluate:  32%|████████████████▊                                   | 45/139 [00:12<00:24,  3.80it/s]
Evaluate:  33%|█████████████████▏                                  | 46/139 [00:13<00:27,  3.38it/s]
Evaluate:  34%|█████████████████▌                                  | 47/139 [00:13<00:27,  3.35it/s]
Evaluate:  35%|█████████████████▉                                  | 48/139 [00:13<00:25,  3.55it/s]
Evaluate:  35%|██████████████████▎                                 | 49/139 [00:14<00:23,  3.88it/s]
Evaluate:  36%|██████████████████▋                                 | 50/139 [00:14<00:22,  4.03it/s]
Evaluate:  37%|███████████████████                                 | 51/139 [00:14<00:24,  3.66it/s]
Evaluate:  37%|███████████████████▍                                | 52/139 [00:14<00:24,  3.59it/s]
Evaluate:  38%|███████████████████▊                                | 53/139 [00:15<00:21,  3.91it/s]
Evaluate:  39%|████████████████████▏                               | 54/139 [00:15<00:24,  3.44it/s]
Evaluate:  40%|████████████████████▌                               | 55/139 [00:15<00:24,  3.44it/s]
Evaluate:  40%|████████████████████▉                               | 56/139 [00:16<00:24,  3.44it/s]
Evaluate:  41%|█████████████████████▎                              | 57/139 [00:16<00:20,  4.08it/s]
Evaluate:  42%|█████████████████████▋                              | 58/139 [00:16<00:19,  4.18it/s]
Evaluate:  42%|██████████████████████                              | 59/139 [00:16<00:19,  4.05it/s]
Evaluate:  43%|██████████████████████▍                             | 60/139 [00:17<00:21,  3.60it/s]
Evaluate:  44%|██████████████████████▊                             | 61/139 [00:17<00:21,  3.55it/s]
Evaluate:  45%|███████████████████████▏                            | 62/139 [00:17<00:22,  3.46it/s]
Evaluate:  45%|███████████████████████▌                            | 63/139 [00:17<00:19,  3.80it/s]
Evaluate:  46%|███████████████████████▉                            | 64/139 [00:18<00:20,  3.69it/s]
Evaluate:  47%|████████████████████████▎                           | 65/139 [00:18<00:18,  3.99it/s]
Evaluate:  47%|████████████████████████▋                           | 66/139 [00:18<00:16,  4.47it/s]
Evaluate:  48%|█████████████████████████                           | 67/139 [00:18<00:15,  4.73it/s]
Evaluate:  49%|█████████████████████████▍                          | 68/139 [00:18<00:14,  4.79it/s]
Evaluate:  50%|█████████████████████████▊                          | 69/139 [00:19<00:14,  4.84it/s]
Evaluate:  50%|██████████████████████████▏                         | 70/139 [00:19<00:16,  4.23it/s]
Evaluate:  51%|██████████████████████████▌                         | 71/139 [00:19<00:15,  4.42it/s]
Evaluate:  52%|██████████████████████████▉                         | 72/139 [00:19<00:16,  4.07it/s]
Evaluate:  53%|███████████████████████████▎                        | 73/139 [00:20<00:16,  4.09it/s]
Evaluate:  53%|███████████████████████████▋                        | 74/139 [00:20<00:15,  4.19it/s]
Evaluate:  54%|████████████████████████████                        | 75/139 [00:20<00:17,  3.59it/s]
Evaluate:  55%|████████████████████████████▍                       | 76/139 [00:20<00:16,  3.81it/s]
Evaluate:  55%|████████████████████████████▊                       | 77/139 [00:21<00:14,  4.31it/s]
Evaluate:  56%|█████████████████████████████▏                      | 78/139 [00:21<00:13,  4.60it/s]
Evaluate:  57%|█████████████████████████████▌                      | 79/139 [00:21<00:13,  4.55it/s]
Evaluate:  58%|█████████████████████████████▉                      | 80/139 [00:21<00:12,  4.66it/s]
Evaluate:  58%|██████████████████████████████▎                     | 81/139 [00:21<00:12,  4.74it/s]
Evaluate:  59%|██████████████████████████████▋                     | 82/139 [00:22<00:14,  3.86it/s]
Evaluate:  60%|███████████████████████████████                     | 83/139 [00:22<00:12,  4.49it/s]
Evaluate:  60%|███████████████████████████████▍                    | 84/139 [00:22<00:11,  4.90it/s]
Evaluate:  61%|███████████████████████████████▊                    | 85/139 [00:22<00:10,  5.23it/s]
Evaluate:  62%|████████████████████████████████▏                   | 86/139 [00:23<00:11,  4.69it/s]
Evaluate:  63%|████████████████████████████████▌                   | 87/139 [00:23<00:09,  5.25it/s]
Evaluate:  63%|████████████████████████████████▉                   | 88/139 [00:23<00:09,  5.51it/s]
Evaluate:  64%|█████████████████████████████████▎                  | 89/139 [00:23<00:09,  5.50it/s]
Evaluate:  65%|█████████████████████████████████▋                  | 90/139 [00:23<00:09,  5.32it/s]
Evaluate:  65%|██████████████████████████████████                  | 91/139 [00:24<00:10,  4.57it/s]
Evaluate:  66%|██████████████████████████████████▍                 | 92/139 [00:24<00:09,  4.97it/s]
Evaluate:  67%|██████████████████████████████████▊                 | 93/139 [00:24<00:08,  5.29it/s]
Evaluate:  68%|███████████████████████████████████▏                | 94/139 [00:24<00:08,  5.01it/s]
Evaluate:  68%|███████████████████████████████████▌                | 95/139 [00:24<00:08,  5.32it/s]
Evaluate:  69%|███████████████████████████████████▉                | 96/139 [00:25<00:09,  4.48it/s]
Evaluate:  70%|████████████████████████████████████▎               | 97/139 [00:25<00:09,  4.23it/s]
Evaluate:  71%|████████████████████████████████████▋               | 98/139 [00:25<00:11,  3.70it/s]
Evaluate:  71%|█████████████████████████████████████               | 99/139 [00:25<00:09,  4.22it/s]
Evaluate:  72%|████████████████████████████████████▋              | 100/139 [00:25<00:08,  4.53it/s]
Evaluate:  73%|█████████████████████████████████████              | 101/139 [00:26<00:10,  3.76it/s]
Evaluate:  73%|█████████████████████████████████████▍             | 102/139 [00:26<00:09,  4.05it/s]
Evaluate:  74%|█████████████████████████████████████▊             | 103/139 [00:26<00:08,  4.39it/s]
Evaluate:  75%|██████████████████████████████████████▏            | 104/139 [00:26<00:07,  4.55it/s]
Evaluate:  76%|██████████████████████████████████████▌            | 105/139 [00:27<00:06,  4.95it/s]
Evaluate:  76%|██████████████████████████████████████▉            | 106/139 [00:27<00:06,  4.95it/s]
Evaluate:  77%|███████████████████████████████████████▎           | 107/139 [00:27<00:07,  4.52it/s]
Evaluate:  78%|███████████████████████████████████████▋           | 108/139 [00:27<00:07,  4.26it/s]
Evaluate:  78%|███████████████████████████████████████▉           | 109/139 [00:28<00:07,  3.97it/s]
Evaluate:  79%|████████████████████████████████████████▎          | 110/139 [00:28<00:06,  4.46it/s]
Evaluate:  80%|████████████████████████████████████████▋          | 111/139 [00:28<00:05,  4.72it/s]
Evaluate:  81%|█████████████████████████████████████████          | 112/139 [00:28<00:05,  4.79it/s]
Evaluate:  81%|█████████████████████████████████████████▍         | 113/139 [00:28<00:05,  4.68it/s]
Evaluate:  82%|█████████████████████████████████████████▊         | 114/139 [00:29<00:05,  4.89it/s]
Evaluate:  83%|██████████████████████████████████████████▏        | 115/139 [00:29<00:05,  4.64it/s]
Evaluate:  83%|██████████████████████████████████████████▌        | 116/139 [00:29<00:05,  4.20it/s]
Evaluate:  84%|██████████████████████████████████████████▉        | 117/139 [00:29<00:04,  4.52it/s]
Evaluate:  85%|███████████████████████████████████████████▎       | 118/139 [00:29<00:04,  4.64it/s]
Evaluate:  86%|███████████████████████████████████████████▋       | 119/139 [00:30<00:05,  3.81it/s]
Evaluate:  86%|████████████████████████████████████████████       | 120/139 [00:30<00:04,  4.09it/s]
Evaluate:  87%|████████████████████████████████████████████▍      | 121/139 [00:30<00:04,  4.42it/s]
Evaluate:  88%|████████████████████████████████████████████▊      | 122/139 [00:30<00:03,  4.42it/s]
Evaluate:  88%|█████████████████████████████████████████████▏     | 123/139 [00:31<00:03,  4.69it/s]
Evaluate:  89%|█████████████████████████████████████████████▍     | 124/139 [00:31<00:03,  4.61it/s]
Evaluate:  90%|█████████████████████████████████████████████▊     | 125/139 [00:31<00:03,  4.19it/s]
Evaluate:  91%|██████████████████████████████████████████████▏    | 126/139 [00:32<00:03,  3.68it/s]
Evaluate:  91%|██████████████████████████████████████████████▌    | 127/139 [00:32<00:03,  3.31it/s]
Evaluate:  92%|██████████████████████████████████████████████▉    | 128/139 [00:32<00:03,  3.58it/s]
Evaluate:  93%|███████████████████████████████████████████████▎   | 129/139 [00:32<00:02,  3.39it/s]
Evaluate:  94%|███████████████████████████████████████████████▋   | 130/139 [00:33<00:02,  3.83it/s]
Evaluate:  94%|████████████████████████████████████████████████   | 131/139 [00:33<00:02,  3.39it/s]
Evaluate:  95%|████████████████████████████████████████████████▍  | 132/139 [00:33<00:02,  3.50it/s]
Evaluate:  96%|████████████████████████████████████████████████▊  | 133/139 [00:33<00:01,  3.83it/s]
Evaluate:  96%|█████████████████████████████████████████████████▏ | 134/139 [00:34<00:01,  4.11it/s]
Evaluate:  97%|█████████████████████████████████████████████████▌ | 135/139 [00:34<00:00,  4.12it/s]
Evaluate:  98%|█████████████████████████████████████████████████▉ | 136/139 [00:34<00:00,  3.55it/s]
Evaluate:  99%|██████████████████████████████████████████████████▎| 137/139 [00:35<00:00,  3.78it/s]
Evaluate:  99%|██████████████████████████████████████████████████▋| 138/139 [00:35<00:00,  4.28it/s]
Evaluate: 100%|███████████████████████████████████████████████████| 139/139 [00:35<00:00,  3.94it/s]
Test set: {'NDCG@10': 0.08059264497040845, 'Recall@10': 0.12104316548906642, 'NDCG@50': 0.0990693530791419, 'Recall@50': 0.20521582738101055, 'MRR': 0.0740310207692732, 'AUC': 0.7291720269395293}
